/* Copyright 2013 The ChromiumOS Authors
 * Use of this source code is governed by a BSD-style license that can be
 * found in the LICENSE file.
 */

#include "cras_metrics.h"

#include <syslog.h>
#include <unistd.h>

struct usb_device {
  int vendor_id;
  int product_id;
};

struct usb_device popular_usb_devices[] = {
    {.vendor_id = 0x582, .product_id = 0x159},
    {.vendor_id = 0x1b3f, .product_id = 0x2008},
    {.vendor_id = 0x0d8c, .product_id = 0x0014},
    {.vendor_id = 0x047f, .product_id = 0xc053},
    {.vendor_id = 0x046d, .product_id = 0x0a8f},
    {.vendor_id = 0x047f, .product_id = 0xc056},
    {.vendor_id = 0x0b0e, .product_id = 0x0300},
    {.vendor_id = 0x046d, .product_id = 0x0a38},
    {.vendor_id = 0x054c, .product_id = 0x09cc},
    {.vendor_id = 0x0b0e, .product_id = 0x0301},
    {.vendor_id = 0x4c4a, .product_id = 0x4155},
    {.vendor_id = 0x0b0e, .product_id = 0x2327},
    {.vendor_id = 0x046d, .product_id = 0x0a6b},
    {.vendor_id = 0x046d, .product_id = 0x0a7a},
    {.vendor_id = 0x001f, .product_id = 0x0b21},
    {.vendor_id = 0x8086, .product_id = 0x0808},
    {.vendor_id = 0x0b0e, .product_id = 0x2315},
    {.vendor_id = 0x045e, .product_id = 0x070f},
    {.vendor_id = 0x0d8c, .product_id = 0x0012},
    {.vendor_id = 0x0b0e, .product_id = 0x0305},
    {.vendor_id = 0x046d, .product_id = 0x0a64},
    {.vendor_id = 0x0b0e, .product_id = 0x2319},
    {.vendor_id = 0x0b0e, .product_id = 0x2304},
    {.vendor_id = 0x0b0e, .product_id = 0x0312},
    {.vendor_id = 0x04e8, .product_id = 0xa051},
    {.vendor_id = 0x046d, .product_id = 0x0a65},
    {.vendor_id = 0x08bb, .product_id = 0x2902},
    {.vendor_id = 0x046d, .product_id = 0x0a44},
    {.vendor_id = 0x047f, .product_id = 0xc055},
    {.vendor_id = 0x05e1, .product_id = 0x202a},
    {.vendor_id = 0x046d, .product_id = 0x0aad},
    {.vendor_id = 0x0b0e, .product_id = 0x0e40},
    {.vendor_id = 0x0b0e, .product_id = 0x0306},
    {.vendor_id = 0x0d8c, .product_id = 0x013c},
    {.vendor_id = 0x046d, .product_id = 0x0a37},
    {.vendor_id = 0x047f, .product_id = 0xc058},
    {.vendor_id = 0x10d6, .product_id = 0xdd00},
    {.vendor_id = 0x0b0e, .product_id = 0x4051},
    {.vendor_id = 0x17ef, .product_id = 0x7231},
    {.vendor_id = 0x0b0e, .product_id = 0x0e41},
    {.vendor_id = 0x047f, .product_id = 0x430a},
    {.vendor_id = 0x047f, .product_id = 0x431b},
    {.vendor_id = 0x054c, .product_id = 0x0ce6},
    {.vendor_id = 0x0c76, .product_id = 0x1262},
    {.vendor_id = 0x1395, .product_id = 0x028e},
    {.vendor_id = 0x0b0e, .product_id = 0x24c7},
    {.vendor_id = 0x1395, .product_id = 0x0291},
    {.vendor_id = 0x1395, .product_id = 0x003c},
    {.vendor_id = 0x0c76, .product_id = 0x161f},
    {.vendor_id = 0x18d1, .product_id = 0x5033},
    {.vendor_id = 0x05ac, .product_id = 0x110b},
    {.vendor_id = 0x046d, .product_id = 0x085b},
    {.vendor_id = 0x0b0e, .product_id = 0x0e31},
    {.vendor_id = 0x1130, .product_id = 0x1620},
    {.vendor_id = 0x047f, .product_id = 0xaf00},
    {.vendor_id = 0x12d1, .product_id = 0x3a07},
    {.vendor_id = 0x17e9, .product_id = 0x6006},
    {.vendor_id = 0x046d, .product_id = 0x0a45},
    {.vendor_id = 0x0bda, .product_id = 0x402e},
    {.vendor_id = 0x0b0e, .product_id = 0x24c8},
    {.vendor_id = 0x0b0e, .product_id = 0x245d},
    {.vendor_id = 0x0b0e, .product_id = 0x2302},
    {.vendor_id = 0x17e9, .product_id = 0x4307},
    {.vendor_id = 0x1395, .product_id = 0x0033},
    {.vendor_id = 0x0d8c, .product_id = 0x000c},
    {.vendor_id = 0x17e9, .product_id = 0x6000},
    {.vendor_id = 0x3391, .product_id = 0x0013},
    {.vendor_id = 0x0b0e, .product_id = 0x0313},
    {.vendor_id = 0x0c76, .product_id = 0x17e0},
    {.vendor_id = 0x17e9, .product_id = 0x436e},
    {.vendor_id = 0x0b0e, .product_id = 0x231a},
    {.vendor_id = 0x047f, .product_id = 0x02e6},
    {.vendor_id = 0x03f0, .product_id = 0x5e4a},
    {.vendor_id = 0x04e8, .product_id = 0xa05e},
    {.vendor_id = 0x0d8c, .product_id = 0x0013},
    {.vendor_id = 0x8087, .product_id = 0x1024},
    {.vendor_id = 0x1532, .product_id = 0x0537},
    {.vendor_id = 0x054c, .product_id = 0x0d5e},
    {.vendor_id = 0x1235, .product_id = 0x8211},
    {.vendor_id = 0x075a, .product_id = 0x079c},
    {.vendor_id = 0x0b0e, .product_id = 0x4001},
    {.vendor_id = 0x1395, .product_id = 0x0052},
    {.vendor_id = 0x31b2, .product_id = 0x0011},
    {.vendor_id = 0x046d, .product_id = 0x0ab7},
    {.vendor_id = 0x046d, .product_id = 0x0825},
    {.vendor_id = 0x046d, .product_id = 0x0a56},
    {.vendor_id = 0x0b0e, .product_id = 0x232a},
    {.vendor_id = 0x0bda, .product_id = 0x4014},
    {.vendor_id = 0x0b0e, .product_id = 0x0420},
    {.vendor_id = 0x0b0e, .product_id = 0x2311},
    {.vendor_id = 0x047f, .product_id = 0x02ee},
    {.vendor_id = 0x18d1, .product_id = 0x5021},
    {.vendor_id = 0x0c76, .product_id = 0x161e},
    {.vendor_id = 0x0b0e, .product_id = 0x4006},
    {.vendor_id = 0x1395, .product_id = 0x0026},
    {.vendor_id = 0x0d8c, .product_id = 0x0139},
    {.vendor_id = 0x1532, .product_id = 0x0504},
    {.vendor_id = 0x03f0, .product_id = 0x056b},
    {.vendor_id = 0x3302, .product_id = 0x3bd2},
    {.vendor_id = 0x0b0e, .product_id = 0x0e30},
    {.vendor_id = 0x3391, .product_id = 0x0015},
    {.vendor_id = 0x1395, .product_id = 0x0025},
    {.vendor_id = 0x0b0e, .product_id = 0x0422},
    {.vendor_id = 0x0d8c, .product_id = 0x0031},
    {.vendor_id = 0x046d, .product_id = 0x0a29},
    {.vendor_id = 0x0b0e, .product_id = 0x0412},
    {.vendor_id = 0x17e9, .product_id = 0x6015},
    {.vendor_id = 0x17e9, .product_id = 0x4349},
    {.vendor_id = 0x1ff7, .product_id = 0x0408},
    {.vendor_id = 0x0b0e, .product_id = 0x2322},
    {.vendor_id = 0x05ac, .product_id = 0x110a},
    {.vendor_id = 0x17e9, .product_id = 0x4323},
    {.vendor_id = 0x0b0e, .product_id = 0x2326},
    {.vendor_id = 0x0d8c, .product_id = 0x0005},
    {.vendor_id = 0x194f, .product_id = 0x0303},
    {.vendor_id = 0x1395, .product_id = 0x0296},
    {.vendor_id = 0x0b0e, .product_id = 0x2324},
    {.vendor_id = 0x0b0e, .product_id = 0x24a3},
    {.vendor_id = 0x0c76, .product_id = 0x168f},
    {.vendor_id = 0xffff, .product_id = 0xffff},
    {.vendor_id = 0x0c45, .product_id = 0x636b},
    {.vendor_id = 0x047f, .product_id = 0x430b},
    {.vendor_id = 0x0c76, .product_id = 0x153f},
    {.vendor_id = 0x0b0e, .product_id = 0x0302},
    {.vendor_id = 0x0b0e, .product_id = 0x0307},
    {.vendor_id = 0x0b0e, .product_id = 0x245e},
    {.vendor_id = 0x1908, .product_id = 0x2070},
    {.vendor_id = 0x047f, .product_id = 0xc054},
    {.vendor_id = 0x1395, .product_id = 0x0016},
    {.vendor_id = 0x1395, .product_id = 0x0284},
    {.vendor_id = 0x046d, .product_id = 0x0843},
    {.vendor_id = 0x047f, .product_id = 0xc008},
    {.vendor_id = 0x6993, .product_id = 0xb017},
    {.vendor_id = 0x1395, .product_id = 0x00b0},
    {.vendor_id = 0x0b0e, .product_id = 0x2301},
    {.vendor_id = 0x413c, .product_id = 0xa503},
    {.vendor_id = 0x18d1, .product_id = 0x5034},
    {.vendor_id = 0x1395, .product_id = 0x00ca},
    {.vendor_id = 0x1778, .product_id = 0x0227},
    {.vendor_id = 0x05e1, .product_id = 0x202b},
    {.vendor_id = 0x046d, .product_id = 0x082d},
    {.vendor_id = 0x6993, .product_id = 0xb04c},
    {.vendor_id = 0x17ef, .product_id = 0xa016},
    {.vendor_id = 0x0d8c, .product_id = 0x0134},
    {.vendor_id = 0x1395, .product_id = 0x0185},
    {.vendor_id = 0x047f, .product_id = 0xc03a},
    {.vendor_id = 0x046d, .product_id = 0x08e5},
    {.vendor_id = 0x0572, .product_id = 0x1807},
    {.vendor_id = 0x1395, .product_id = 0x0024},
    {.vendor_id = 0x1395, .product_id = 0x0298},
    {.vendor_id = 0x047f, .product_id = 0xac01},
    {.vendor_id = 0x17ef, .product_id = 0xa396},
    {.vendor_id = 0x046d, .product_id = 0x0a55},
    {.vendor_id = 0x0c76, .product_id = 0x1a23},
    {.vendor_id = 0x0b0e, .product_id = 0x030c},
    {.vendor_id = 0xe5b7, .product_id = 0x0811},
    {.vendor_id = 0x1235, .product_id = 0x8210},
    {.vendor_id = 0x1b3f, .product_id = 0x2021},
    {.vendor_id = 0x047f, .product_id = 0xc057},
    {.vendor_id = 0x3206, .product_id = 0x106b},
    {.vendor_id = 0x31b2, .product_id = 0x0010},
    {.vendor_id = 0x047f, .product_id = 0x430c},
    {.vendor_id = 0x0b0e, .product_id = 0x2453},
    {.vendor_id = 0x17ef, .product_id = 0x60f4},
    {.vendor_id = 0x046d, .product_id = 0x0ac4},
    {.vendor_id = 0x0b0e, .product_id = 0x2466},
    {.vendor_id = 0x0c76, .product_id = 0x120c},
    {.vendor_id = 0x0d8c, .product_id = 0x016c},
    {.vendor_id = 0xb58e, .product_id = 0x9e84},
    {.vendor_id = 0x1ff7, .product_id = 0x0f27},
    {.vendor_id = 0x047f, .product_id = 0x430e},
    {.vendor_id = 0x046d, .product_id = 0x0ab5},
    {.vendor_id = 0x0572, .product_id = 0x1433},
    {.vendor_id = 0x045e, .product_id = 0x0837},
    {.vendor_id = 0x0b0e, .product_id = 0x0303},
    {.vendor_id = 0x16d0, .product_id = 0x0dab},
    {.vendor_id = 0x0d8c, .product_id = 0x013a},
    {.vendor_id = 0x0b0e, .product_id = 0x0410},
    {.vendor_id = 0x0c76, .product_id = 0x1a24},
    {.vendor_id = 0x03f0, .product_id = 0x879d},
    {.vendor_id = 0x047f, .product_id = 0xaf03},
    {.vendor_id = 0x1395, .product_id = 0x0286},
    {.vendor_id = 0x0b0e, .product_id = 0x1121},
    {.vendor_id = 0x0b0e, .product_id = 0x24c9},
    {.vendor_id = 0x3142, .product_id = 0x5060},
    {.vendor_id = 0x1235, .product_id = 0x0003},
    {.vendor_id = 0x046d, .product_id = 0x085c},
    {.vendor_id = 0x047f, .product_id = 0xaf01},
    {.vendor_id = 0x046d, .product_id = 0x0acb},
    {.vendor_id = 0x17ef, .product_id = 0x30b0},
    {.vendor_id = 0x145f, .product_id = 0x02dd},
    {.vendor_id = 0x0951, .product_id = 0x16a4},
    {.vendor_id = 0x18d1, .product_id = 0x8001},
    {.vendor_id = 0x6993, .product_id = 0xb20a},
    {.vendor_id = 0x17e9, .product_id = 0x4301},
    {.vendor_id = 0xbe57, .product_id = 0x0238},
    {.vendor_id = 0x0b0e, .product_id = 0xa710},
    {.vendor_id = 0x1395, .product_id = 0x0032},
    {.vendor_id = 0x3302, .product_id = 0x29c4},
    {.vendor_id = 0x17ef, .product_id = 0x612c},
    {.vendor_id = 0x047f, .product_id = 0xc012},
    {.vendor_id = 0x03f0, .product_id = 0x0269},
    {.vendor_id = 0x10f5, .product_id = 0x220d},
    {.vendor_id = 0x0d8c, .product_id = 0x0103},
    {.vendor_id = 0x1b3f, .product_id = 0x2247},
    {.vendor_id = 0x0b0e, .product_id = 0x030b},
    {.vendor_id = 0x145f, .product_id = 0x02d2},
    {.vendor_id = 0x046d, .product_id = 0x0a0c},
    {.vendor_id = 0x075a, .product_id = 0x076c},
    {.vendor_id = 0x0b0e, .product_id = 0x2e40},
    {.vendor_id = 0x041e, .product_id = 0x3277},
    {.vendor_id = 0x046d, .product_id = 0x0892},
    {.vendor_id = 0x1038, .product_id = 0x12b3},
    {.vendor_id = 0x4c4a, .product_id = 0x3435},
    {.vendor_id = 0x17e9, .product_id = 0x601e},
    {.vendor_id = 0x1532, .product_id = 0x0527},
    {.vendor_id = 0x1395, .product_id = 0x0099},
    {.vendor_id = 0x047f, .product_id = 0xc034},
    {.vendor_id = 0x2d30, .product_id = 0x5056},
    {.vendor_id = 0x08bb, .product_id = 0x29c0},
    {.vendor_id = 0x0bda, .product_id = 0x482a},
    {.vendor_id = 0x1b1c, .product_id = 0x0a51},
    {.vendor_id = 0xb58e, .product_id = 0x0005},
    {.vendor_id = 0x047f, .product_id = 0x4315},
    {.vendor_id = 0x17e9, .product_id = 0x600a},
    {.vendor_id = 0x17ef, .product_id = 0x30bb},
    {.vendor_id = 0x046d, .product_id = 0x085e},
    {.vendor_id = 0x046d, .product_id = 0x0867},
    {.vendor_id = 0x10d6, .product_id = 0x4801},
    {.vendor_id = 0x0bda, .product_id = 0x875b},
    {.vendor_id = 0x0495, .product_id = 0x3042},
    {.vendor_id = 0x1778, .product_id = 0xd001},
    {.vendor_id = 0x2207, .product_id = 0x0019},
    {.vendor_id = 0x2ea1, .product_id = 0x011a},
    {.vendor_id = 0x2ea1, .product_id = 0x2130},
    {.vendor_id = 0x05a3, .product_id = 0x9331},
    {.vendor_id = 0x1b1c, .product_id = 0x0a4d},
    {.vendor_id = 0x413c, .product_id = 0xa516},
    {.vendor_id = 0x1395, .product_id = 0x0382},
    {.vendor_id = 0x2574, .product_id = 0x100a},
    {.vendor_id = 0x1778, .product_id = 0xd021},
    {.vendor_id = 0x0bda, .product_id = 0x4e0a},
    {.vendor_id = 0x0c76, .product_id = 0x0a23},
    {.vendor_id = 0x17ef, .product_id = 0x3063},
    {.vendor_id = 0x10f5, .product_id = 0x2186},
    {.vendor_id = 0x0c45, .product_id = 0x6366},
    {.vendor_id = 0x08a8, .product_id = 0x0016},
    {.vendor_id = 0x03f0, .product_id = 0x2147},
    {.vendor_id = 0x17ef, .product_id = 0xa069},
    {.vendor_id = 0x0b0e, .product_id = 0x2465},
    {.vendor_id = 0x0909, .product_id = 0x001c},
    {.vendor_id = 0x0b0e, .product_id = 0x1113},
    {.vendor_id = 0x16d0, .product_id = 0x08b3},
    {.vendor_id = 0x0c76, .product_id = 0x160b},
    {.vendor_id = 0x046d, .product_id = 0x0adf},
    {.vendor_id = 0x17e9, .product_id = 0x6028},
    {.vendor_id = 0x1532, .product_id = 0x0531},
    {.vendor_id = 0x046d, .product_id = 0x0a9c},
    {.vendor_id = 0x1038, .product_id = 0x12aa},
    {.vendor_id = 0x22d9, .product_id = 0x9101},
    {.vendor_id = 0x17ef, .product_id = 0xa032},
    {.vendor_id = 0x04f2, .product_id = 0xb3eb},
    {.vendor_id = 0x290b, .product_id = 0x0900},
    {.vendor_id = 0x0a67, .product_id = 0x11c0},
    {.vendor_id = 0x0b0e, .product_id = 0x2475},
    {.vendor_id = 0x1395, .product_id = 0x00cb},
    {.vendor_id = 0x08bb, .product_id = 0x2912},
    {.vendor_id = 0x0b0e, .product_id = 0x1016},
    {.vendor_id = 0x0b0e, .product_id = 0x111a},
    {.vendor_id = 0x413c, .product_id = 0xa513},
    {.vendor_id = 0x0a67, .product_id = 0xc006},
    {.vendor_id = 0x0b0e, .product_id = 0x030e},
    {.vendor_id = 0x2894, .product_id = 0x0012},
    {.vendor_id = 0x20b1, .product_id = 0x0011},
    {.vendor_id = 0x046d, .product_id = 0x0aba},
    {.vendor_id = 0x0c76, .product_id = 0x1607},
    {.vendor_id = 0x3142, .product_id = 0x0658},
    {.vendor_id = 0x047f, .product_id = 0x02f7},
    {.vendor_id = 0x046d, .product_id = 0x0afe},
    {.vendor_id = 0x17e9, .product_id = 0x6004},
    {.vendor_id = 0x1532, .product_id = 0x0526},
    {.vendor_id = 0x0572, .product_id = 0x1b08},
    {.vendor_id = 0x17e9, .product_id = 0x4306},
    {.vendor_id = 0x0b0e, .product_id = 0x0e35},
    {.vendor_id = 0x041e, .product_id = 0x3272},
    {.vendor_id = 0x1532, .product_id = 0x0529},
    {.vendor_id = 0x1235, .product_id = 0x0002},
    {.vendor_id = 0x17ef, .product_id = 0x611d},
    {.vendor_id = 0x0c76, .product_id = 0x2018},
    {.vendor_id = 0x046d, .product_id = 0x0aaa},
    {.vendor_id = 0x1395, .product_id = 0x0287},
    {.vendor_id = 0x047f, .product_id = 0xc025},
    {.vendor_id = 0x045e, .product_id = 0x077f},
    {.vendor_id = 0x1532, .product_id = 0x051e},
    {.vendor_id = 0x17ef, .product_id = 0x3083},
    {.vendor_id = 0x1395, .product_id = 0x0285},
    {.vendor_id = 0x046d, .product_id = 0x082c},
    {.vendor_id = 0x0d8c, .product_id = 0x0721},
    {.vendor_id = 0x046d, .product_id = 0x0aee},
    {.vendor_id = 0x047f, .product_id = 0x0156},
    {.vendor_id = 0x0b0e, .product_id = 0x0314},
    {.vendor_id = 0x0b0e, .product_id = 0x0852},
    {.vendor_id = 0x0951, .product_id = 0x1713},
    {.vendor_id = 0x1532, .product_id = 0x0552},
    {.vendor_id = 0x17e9, .product_id = 0x6011},
    {.vendor_id = 0x2acf, .product_id = 0x0b21},
    {.vendor_id = 0x1532, .product_id = 0x054e},
    {.vendor_id = 0x2d0b, .product_id = 0x0001},
    {.vendor_id = 0x1235, .product_id = 0x8205},
    {.vendor_id = 0x03f0, .product_id = 0x0a93},
    {.vendor_id = 0x03f0, .product_id = 0x1841},
    {.vendor_id = 0x0b0e, .product_id = 0x2476},
    {.vendor_id = 0x17e9, .product_id = 0x602f},
    {.vendor_id = 0x2000, .product_id = 0xdd00},
    {.vendor_id = 0x1532, .product_id = 0x0521},
    {.vendor_id = 0x0020, .product_id = 0x0b21},
    {.vendor_id = 0x0c76, .product_id = 0x1608},
    {.vendor_id = 0x12d1, .product_id = 0x0010},
    {.vendor_id = 0x0bda, .product_id = 0x4c07},
    {.vendor_id = 0x10f5, .product_id = 0x0141},
    {.vendor_id = 0x0b0e, .product_id = 0x2505},
    {.vendor_id = 0x047f, .product_id = 0xac29},
    {.vendor_id = 0x04e8, .product_id = 0xa059},
    {.vendor_id = 0x04e8, .product_id = 0xa05b},
    {.vendor_id = 0x17e9, .product_id = 0x6008},
    {.vendor_id = 0x03f0, .product_id = 0x0b92},
    {.vendor_id = 0x534d, .product_id = 0x2109},
    {.vendor_id = 0x03f0, .product_id = 0x0d87},
    {.vendor_id = 0x1532, .product_id = 0x0536},
    {.vendor_id = 0x0ecb, .product_id = 0x206b},
    {.vendor_id = 0x413c, .product_id = 0xa510},
    {.vendor_id = 0x3391, .product_id = 0x0002},
    {.vendor_id = 0x08bb, .product_id = 0x2704},
    {.vendor_id = 0x6993, .product_id = 0xb120},
    {.vendor_id = 0x301a, .product_id = 0x0602},
    {.vendor_id = 0x04e8, .product_id = 0xa057},
    {.vendor_id = 0x0b0e, .product_id = 0xa50c},
    {.vendor_id = 0x1b3f, .product_id = 0x2012},
    {.vendor_id = 0x0d8c, .product_id = 0x0022},
    {.vendor_id = 0x0b0e, .product_id = 0x0308},
    {.vendor_id = 0x3302, .product_id = 0x29e3},
    {.vendor_id = 0x0c76, .product_id = 0x1675},
    {.vendor_id = 0x0b0e, .product_id = 0x0349},
    {.vendor_id = 0x0b0e, .product_id = 0x24ca},
    {.vendor_id = 0x2ea1, .product_id = 0x2121},
    {.vendor_id = 0x1395, .product_id = 0x0299},
    {.vendor_id = 0x04fc, .product_id = 0x2680},
    {.vendor_id = 0x03f0, .product_id = 0x0491},
    {.vendor_id = 0x194f, .product_id = 0x0403},
    {.vendor_id = 0x1b3f, .product_id = 0x2002},
    {.vendor_id = 0x047f, .product_id = 0xab01},
    {.vendor_id = 0x047f, .product_id = 0x013c},
    {.vendor_id = 0x04e8, .product_id = 0xa04f},
    {.vendor_id = 0x1025, .product_id = 0x1652},
    {.vendor_id = 0x2d30, .product_id = 0x8055},
    {.vendor_id = 0x0ecb, .product_id = 0x2039},
    {.vendor_id = 0x0e6f, .product_id = 0x0232},
    {.vendor_id = 0x0c76, .product_id = 0x1a22},
    {.vendor_id = 0x0b0e, .product_id = 0x24fc},
    {.vendor_id = 0x31b2, .product_id = 0x0111},
    {.vendor_id = 0x03f0, .product_id = 0x0d8b},
    {.vendor_id = 0x18d1, .product_id = 0x2d02},
    {.vendor_id = 0x0d8c, .product_id = 0x0102},
    {.vendor_id = 0x6993, .product_id = 0xb043},
    {.vendor_id = 0x1038, .product_id = 0x12ad},
    {.vendor_id = 0x1908, .product_id = 0x2220},
    {.vendor_id = 0x046d, .product_id = 0x0ade},
    {.vendor_id = 0x17ef, .product_id = 0x30d1},
    {.vendor_id = 0x05fc, .product_id = 0x0231},
    {.vendor_id = 0x0951, .product_id = 0x1718},
    {.vendor_id = 0x17ee, .product_id = 0x0a15},
    {.vendor_id = 0x17e9, .product_id = 0x4333},
    {.vendor_id = 0x046d, .product_id = 0x0aaf},
    {.vendor_id = 0x0b05, .product_id = 0x19c5},
    {.vendor_id = 0x17ef, .product_id = 0xa05c},
    {.vendor_id = 0x046d, .product_id = 0x081b},
    {.vendor_id = 0x047f, .product_id = 0xc036},
    {.vendor_id = 0x046d, .product_id = 0x0ada},
    {.vendor_id = 0x2d0b, .product_id = 0x0010},
    {.vendor_id = 0x1d6c, .product_id = 0x0103},
    {.vendor_id = 0x047f, .product_id = 0xac2b},
    {.vendor_id = 0x2166, .product_id = 0x9021},
    {.vendor_id = 0x1bcf, .product_id = 0x28c4},
    {.vendor_id = 0x3391, .product_id = 0x0006},
    {.vendor_id = 0x0572, .product_id = 0x0005},
    {.vendor_id = 0x1224, .product_id = 0x2a25},
    {.vendor_id = 0x0031, .product_id = 0x1133},
    {.vendor_id = 0x352f, .product_id = 0x0105},
    {.vendor_id = 0x0b0e, .product_id = 0x24fd},
    {.vendor_id = 0x046d, .product_id = 0x0a66},
    {.vendor_id = 0x0d8c, .product_id = 0x0030},
    {.vendor_id = 0xf389, .product_id = 0x0168},
    {.vendor_id = 0x046d, .product_id = 0x0a90},
    {.vendor_id = 0x0b0e, .product_id = 0x1134},
    {.vendor_id = 0x0bda, .product_id = 0x4a72},
    {.vendor_id = 0x0951, .product_id = 0x1723},
    {.vendor_id = 0x2a70, .product_id = 0x1881},
    {.vendor_id = 0x0572, .product_id = 0x141b},
    {.vendor_id = 0x17e9, .product_id = 0x6013},
    {.vendor_id = 0x046d, .product_id = 0x0a46},
    {.vendor_id = -1, .product_id = 0},
};

bool in_popular_usb_devices(int vid, int pid) {
  int i = 0;
  for (i = 0; popular_usb_devices[i].vendor_id != -1; i++) {
    if (popular_usb_devices[i].vendor_id == vid &&
        popular_usb_devices[i].product_id == pid) {
      return true;
    }
  }
  return false;
}

#if HAVE_LIB_METRICS
#include <metrics/c_metrics_library.h>

#include "metrics/c_structured_metrics.h"

void cras_metrics_log_event(const char* event) {
  CMetricsLibrary handle;

  syslog(LOG_DEBUG, "UMA event: %s", event);
  handle = CMetricsLibraryNew();
  CMetricsLibrarySendCrosEventToUMA(handle, event);
  CMetricsLibraryDelete(handle);
}

void cras_metrics_log_histogram(const char* name,
                                int sample,
                                int min,
                                int max,
                                int nbuckets) {
  CMetricsLibrary handle;

  syslog(LOG_DEBUG, "UMA name: %s", name);
  handle = CMetricsLibraryNew();
  CMetricsLibrarySendToUMA(handle, name, sample, min, max, nbuckets);
  CMetricsLibraryDelete(handle);
}

void cras_metrics_log_sparse_histogram(const char* name, int sample) {
  CMetricsLibrary handle;

  syslog(LOG_DEBUG, "UMA name: %s", name);
  handle = CMetricsLibraryNew();
  CMetricsLibrarySendSparseToUMA(handle, name, sample);
  CMetricsLibraryDelete(handle);
}

void audio_peripheral_info(int vendor_id, int product_id, int type) {
  syslog(LOG_DEBUG, "AudioPeripheralInfo vid: %x, pid: %x, type: %d", vendor_id,
         product_id, type);
  AudioPeripheralInfo(vendor_id, product_id, type);
}

void audio_peripheral_close(int vendor_id,
                            int product_id,
                            int type,
                            int run_time,
                            int rate,
                            int channel,
                            int format) {
  if (in_popular_usb_devices(vendor_id, product_id)) {
    syslog(LOG_DEBUG,
           "AudioPeripheralClose vid: %x, pid: %x, type: %d, run_time: %d, "
           "rate: %d, channel: %d, format:%d",
           vendor_id, product_id, type, run_time, rate, channel, format);
    AudioPeripheralClose(vendor_id, product_id, type, run_time, rate, channel,
                         format);
  }
}

#else
void cras_metrics_log_event(const char* event) {}
void cras_metrics_log_histogram(const char* name,
                                int sample,
                                int min,
                                int max,
                                int nbuckets) {}
void cras_metrics_log_enum_histogram(const char* name, int sample, int max) {}
void cras_metrics_log_sparse_histogram(const char* name, int sample) {}

void audio_peripheral_info(int vendor_id, int product_id, int type) {}
void audio_peripheral_close(int vendor_id,
                            int product_id,
                            int type,
                            int run_time,
                            int rate,
                            int channel,
                            int format) {}

#endif
